<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meal View</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../assets/css/styles.css">
</head>

<body>
    <div class="view-container container py-4">
        <div class="custom-box p-4" id="print-section">

            <!-- Meal Info Section -->
            <div class="card view-card mb-4">
                <div class="card-header view-header">Meal Information</div>
                <div class="card-body">
                    <div class="row g-3 align-items-center">
                        <div class="col-md-4">
                            <label class="form-label view-label">Meal Type</label>
                            <input type="text" class="form-control view-select" value="Breakfast" readonly>

                        </div>

                        <div class="col-md-4 text-center">
                            <label class="form-label view-label">Selected Item</label>
                            <img src="../assets/images/pongal.jpeg" alt="Pongal" class="view-item-img mb-2">
                            <p class="view-item-name">Pongal</p>
                        </div>

                        <div class="col-md-4">
                            <label class="form-label view-label">Quantity</label>
                            <input type="text" class="form-control view-input" value="4 Buckets">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ingredients Table -->
            <div class="card view-card mb-4">
                <div class="card-header view-header">Ingredients Required</div>
                <div class="card-body">
                    <table class="table table-bordered table-striped view-table">
                        <thead>
                            <tr>
                                <th>Ingredient Name</th>
                                <th>UOM</th>
                                <th>Required Qty</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Raw Rice</td>
                                <td>Kg</td>
                                <td>1.0</td>
                            </tr>
                            <tr>
                                <td>Moong Dal</td>
                                <td>Kg</td>
                                <td>0.5</td>
                            </tr>
                            <tr>
                                <td>Ghee</td>
                                <td>Kg</td>
                                <td>0.2</td>
                            </tr>
                            <tr>
                                <td>Black Pepper</td>
                                <td>Gram</td>
                                <td>20</td>
                            </tr>
                            <tr>
                                <td>Cumin Seeds</td>
                                <td>Gram</td>
                                <td>15</td>
                            </tr>
                            <tr>
                                <td>Curry Leaves</td>
                                <td>Sprig</td>
                                <td>2</td>
                            </tr>
                            <tr>
                                <td>Salt</td>
                                <td>Gram</td>
                                <td>20</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Added Items Table -->
            <div class="card view-card">
                <div class="card-header view-header">Added Items List</div>
                <div class="card-body">
                    <table class="table table-bordered table-hover view-table">
                        <thead>
                            <tr>
                                <th>S.No</th>
                                <th>Image</th>
                                <th>Item Name</th>
                                <th>Qty</th>
                                <th>UOM</th>
                                <th>Bucket</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td><img src="../assets/images/pongal.jpeg" class="view-mini-img"></td>
                                <td>Pongal</td>
                                <td>4</td>
                                <td>Buckets</td>
                                <td>20</td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td><img src="../assets/images/sambar.jpeg" class="view-mini-img"></td>
                                <td>Sambar</td>
                                <td>1</td>
                                <td>Bucket</td>
                                <td>30</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

        </div>

        <!-- Buttons for Print and PDF -->
        <div class="text-center mt-4">
            <button class="btn btn-primary me-2" onclick="printPage()">ðŸ–¨ Print</button>
            <button class="btn btn-success" id="downloadBtn">â¬‡ Download PDF</button>
        </div>
    </div>

    <!-- JS Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>

    <script>
        // Print
        function printPage() {
            window.print();
        }

        // Download PDF
        document.getElementById("downloadBtn").addEventListener("click", function () {
            const element = document.getElementById("print-section");

            const opt = {
                margin: 0.5,
                filename: 'Meal-View.pdf',
                image: {
                    type: 'jpeg',
                    quality: 1
                },
                html2canvas: {
                    scale: 2,
                    useCORS: true
                },
                jsPDF: {
                    unit: 'in',
                    format: 'a4',
                    orientation: 'portrait'
                }
            };

            // Proper promise chain
            html2pdf().set(opt).from(element).toPdf().get('pdf').then(function (pdf) {
                pdf.save('Meal-View.pdf');
            });
        });
    </script>
</body>

</html>